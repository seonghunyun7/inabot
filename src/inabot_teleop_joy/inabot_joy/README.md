inabot_joy

inabot_joy ì¡°ì´ìŠ¤í‹± ë˜ëŠ” ê²Œì„íŒ¨ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ lrbot2 ë¡œë´‡ì„ ìˆ˜ë™ìœ¼ë¡œ ì œì–´í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ROS2 íŒ¨í‚¤ì§€ì…ë‹ˆë‹¤. ì´ íŒ¨í‚¤ì§€ëŠ” joy ë…¸ë“œë¡œë¶€í„° ì…ë ¥ì„ ë°›ì•„ ì´ë¥¼ ë¡œë´‡ì˜ ì œì–´ ëª…ë ¹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê¸°ëŠ¥ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
ğŸ“¦ ì£¼ìš” êµ¬ì„± ìš”ì†Œ

    ì†ŒìŠ¤ ì½”ë“œ (src/)

        joy_control.cpp: ì¡°ì´ìŠ¤í‹± ì…ë ¥ì„ ë°›ì•„ Twist ë©”ì‹œì§€ë¡œ ë³€í™˜í•˜ì—¬ í¼ë¸”ë¦¬ì‹œí•˜ëŠ” ë…¸ë“œ

    ëŸ°ì¹˜ íŒŒì¼ (launch/)

        joy_start.launch.py: ì¡°ì´ìŠ¤í‹± ì œì–´ë¥¼ ì‹œì‘í•˜ê¸° ìœ„í•œ ëŸ°ì¹˜ íŒŒì¼

    CMakeLists.txt: íŒ¨í‚¤ì§€ ë¹Œë“œë¥¼ ìœ„í•œ CMake ì„¤ì • íŒŒì¼

    package.xml: íŒ¨í‚¤ì§€ ë©”íƒ€ë°ì´í„° ë° ì˜ì¡´ì„± ê´€ë¦¬ íŒŒì¼

ğŸ“‚ ë””ë ‰í† ë¦¬ êµ¬ì¡°

â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ launch
â”‚   â””â”€â”€ joy_start.launch.py
â”œâ”€â”€ package.xml
â”œâ”€â”€ README.md
â””â”€â”€ src
    â””â”€â”€ joy_control.cpp

ğŸ§‘â€ğŸ’» ì£¼ìš” ê¸°ëŠ¥ ì„¤ëª…
1. joy_control.cpp

    ROS2ì˜ sensor_msgs/msg/Joy ë©”ì‹œì§€ë¥¼ êµ¬ë…í•˜ì—¬ ì¡°ì´ìŠ¤í‹± ì…ë ¥ì„ ìˆ˜ì‹ í•©ë‹ˆë‹¤.

    ì…ë ¥ëœ ì¶•(axis)ê³¼ ë²„íŠ¼(button) ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ ë¡œë´‡ì˜ ì´ë™ ëª…ë ¹(geometry_msgs/msg/Twist)ì„ ìƒì„±í•˜ê³  í¼ë¸”ë¦¬ì‹œí•©ë‹ˆë‹¤.

    ì¼ë°˜ì ìœ¼ë¡œ ì™¼ìª½ ìŠ¤í‹±ì€ ì§ì§„/í›„ì§„ ë° ì¢Œìš° íšŒì „ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.

2. joy_start.launch.py

    ì¡°ì´ìŠ¤í‹± ì¥ì¹˜ ë…¸ë“œ(joy_node)ì™€ joy_control ë…¸ë“œë¥¼ í•¨ê»˜ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•˜ëŠ” ëŸ°ì¹˜ íŒŒì¼ì…ë‹ˆë‹¤.

    ì¡°ì´ìŠ¤í‹± ì¢…ë¥˜ì— ë”°ë¼ /dev/input/jsX ë˜ëŠ” ë§¤í•‘ ì„¤ì •ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ğŸš€ íŒ¨í‚¤ì§€ ë¹Œë“œ

ì´ íŒ¨í‚¤ì§€ë¥¼ ë¹Œë“œí•˜ë ¤ë©´, ROS2 ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì˜ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”:

colcon build --packages-select inabot_joy
colcon build --symlink-install --packages-select inabot_joy

ë¹Œë“œ í›„ í™˜ê²½ì„ ì„¤ì •í•©ë‹ˆë‹¤:

source install/setup.bash

ğŸ•¹ï¸ ì‚¬ìš© ì˜ˆì‹œ
1. ëŸ°ì¹˜ íŒŒì¼ì„ í†µí•œ ì‹¤í–‰

ros2 launch inabot_joy joy_start.launch.py

2. ì¡°ì´ìŠ¤í‹± ë§¤í•‘ ì„¤ì •

ê¸°ë³¸ì ìœ¼ë¡œ Xbox ì»¨íŠ¸ë¡¤ëŸ¬ ë˜ëŠ” PS4 íŒ¨ë“œ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë˜ì–´ ìˆìœ¼ë©°, ì‚¬ìš© í™˜ê²½ì— ë”°ë¼ joy_control.cpp ë‚´ ë§¤í•‘ ì„¤ì •ì„ ìˆ˜ì •í•´ì•¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ğŸ”§ ì˜ì¡´ì„±

    sensor_msgs: ì¡°ì´ìŠ¤í‹± ì…ë ¥ ë©”ì‹œì§€

    geometry_msgs: ë¡œë´‡ì˜ ì´ë™ ëª…ë ¹ ë©”ì‹œì§€

    rclcpp, std_msgs: ROS2 ê¸°ë³¸ ë©”ì‹œì§€ ë° ë…¸ë“œ ì‹¤í–‰

ğŸ“Œ ì°¸ê³ 

    ì¡°ì´ìŠ¤í‹±ì´ ì¸ì‹ë˜ì§€ ì•Šìœ¼ë©´ ls /dev/input/ ë˜ëŠ” jstest ëª…ë ¹ì–´ë¡œ ì—°ê²° ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”.

    udev ê·œì¹™ì´ë‚˜ ê¶Œí•œ ì„¤ì •ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤ (/dev/input/js0 ì ‘ê·¼ ê¶Œí•œ ë“±).


    sudo nano /etc/udev/rules.d/99-joystick.rules
    KERNEL=="js[0-9]*", MODE="0666"
    sudo udevadm control --reload-rules
    sudo udevadm trigger
    ls -l /dev/input/js0    
    crw-rw-rw- ì²˜ëŸ¼ ì½ê¸°/ì“°ê¸° ê¶Œí•œì´ ì ìš©ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.


# -------------------------------
# Logitech F310/F710 ì¡°ì´ìŠ¤í‹± ê³ ì •
# -------------------------------
KERNEL=="js[0-9]*", ATTRS{idVendor}=="046d", ATTRS{idProduct}=="c216", MODE:="0666", SYMLINK+="my_joystick"


Bus 001 Device 005: ID 046d:c216 Logitech, Inc. F310 Gamepad
â†’ Vendor: 046d, Product: c216
->SYMLINK+="my_joystick" â†’ /dev/my_joystickë¼ëŠ” ê³ ì • ì¥ì¹˜ ì´ë¦„ ìƒì„±

sudo udevadm control --reload-rules
sudo udevadm trigger
ì´ì œ USB ì—°ê²° ì‹œ /dev/my_joystickë¡œ ì ‘ê·¼ ê°€ëŠ¥

2ï¸âƒ£ udev ê¸°ë°˜ ì ‘ê·¼
USB ì¡°ì´ìŠ¤í‹± ì—°ê²°
        â”‚
        â–¼
   Linux ì»¤ë„ /dev/input/jsN
        â”‚
        â–¼
    joy_node device_id:=0

    device_id:=0 â†’ ì²« ë²ˆì§¸ ì¸ì‹ëœ ì¡°ì´ìŠ¤í‹± (/dev/input/js0)

    ë¬¸ì œì :

        USB í¬íŠ¸ ìˆœì„œê°€ ë°”ë€Œë©´ /dev/input/js0ê°€ ë‹¬ë¼ì§

        ì—¬ëŸ¬ ì¥ì¹˜ ì—°ê²° ì‹œ ìˆœì„œê°€ ë°”ë€” ìˆ˜ ìˆìŒ

2ï¸âƒ£ udev ê¸°ë°˜ ì ‘ê·¼
USB ì¡°ì´ìŠ¤í‹± ì—°ê²°
        â”‚
    udev ê·œì¹™ ì ìš©
        â”‚
        â–¼
   /dev/my_joystick  <-- ê³ ì • ì´ë¦„
        â”‚
        â–¼
    joy_node dev:=/dev/my_joystick
